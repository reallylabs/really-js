/*!
 *  Really.js v0.0.1
 *  Copyright (C) 2014-2015 Really Inc. <http://really.io>
 *
 *  Date:  Sat May 09 2015 20:15:49
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),n.Really=t()}}(function(){var t;return function n(t,e,r){function o(u,a){if(!e[u]){if(!t[u]){var c="function"==typeof require&&require;if(!a&&c)return c(u,!0);if(i)return i(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var f=e[u]={exports:{}};t[u][0].call(f.exports,function(n){var e=t[u][1][n];return o(e?e:n)},f,f.exports,n,t,e,r)}return e[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(t,n,e){function r(){}var o=n.exports={};o.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,n="undefined"!=typeof window&&window.MutationObserver,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};var r=[];if(n){var o=document.createElement("div"),i=new MutationObserver(function(){var t=r.slice();r.length=0,t.forEach(function(t){t()})});return i.observe(o,{attributes:!0}),function(t){r.length||o.setAttribute("yes","no"),r.push(t)}}return e?(window.addEventListener("message",function(t){var n=t.source;if((n===window||null===n)&&"process-tick"===t.data&&(t.stopPropagation(),r.length>0)){var e=r.shift();e()}},!0),function(t){r.push(t),window.postMessage("process-tick","*")}):function(t){setTimeout(t,0)}}(),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=r,o.addListener=r,o.once=r,o.off=r,o.removeListener=r,o.removeAllListeners=r,o.emit=r,o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],2:[function(t,n,e){function r(t){return t?o(t):void 0}function o(t){for(var n in r.prototype)t[n]=r.prototype[n];return t}n.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,n){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(n),this},r.prototype.once=function(t,n){function e(){r.off(t,e),n.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},e.fn=n,this.on(t,e),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,n){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var e=this._callbacks[t];if(!e)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var r,o=0;o<e.length;o++)if(r=e[o],r===n||r.fn===n){e.splice(o,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var n=[].slice.call(arguments,1),e=this._callbacks[t];if(e){e=e.slice(0);for(var r=0,o=e.length;o>r;++r)e[r].apply(this,n)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],3:[function(n,e,r){(function(n){(function(){function o(t,n,e){for(var r=(e||0)-1,o=t?t.length:0;++r<o;)if(t[r]===n)return r;return-1}function i(t,n){var e=typeof n;if(t=t.cache,"boolean"==e||null==n)return t[n]?0:-1;"number"!=e&&"string"!=e&&(e="object");var r="number"==e?n:k+n;return t=(t=t[e])&&t[r],"object"==e?t&&o(t,n)>-1?0:-1:t?0:-1}function u(t){var n=this.cache,e=typeof t;if("boolean"==e||null==t)n[t]=!0;else{"number"!=e&&"string"!=e&&(e="object");var r="number"==e?t:k+t,o=n[e]||(n[e]={});"object"==e?(o[r]||(o[r]=[])).push(t):o[r]=!0}}function a(t){return t.charCodeAt(0)}function c(t,n){for(var e=t.criteria,r=n.criteria,o=-1,i=e.length;++o<i;){var u=e[o],a=r[o];if(u!==a){if(u>a||"undefined"==typeof u)return 1;if(a>u||"undefined"==typeof a)return-1}}return t.index-n.index}function s(t){var n=-1,e=t.length,r=t[0],o=t[e/2|0],i=t[e-1];if(r&&"object"==typeof r&&o&&"object"==typeof o&&i&&"object"==typeof i)return!1;var a=p();a["false"]=a["null"]=a["true"]=a.undefined=!1;var c=p();for(c.array=t,c.cache=a,c.push=u;++n<e;)c.push(t[n]);return c}function f(t){return"\\"+J[t]}function l(){return g.pop()||[]}function p(){return b.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function h(t){t.length=0,g.length<j&&g.push(t)}function d(t){var n=t.cache;n&&d(n),t.array=t.cache=t.criteria=t.object=t.number=t.string=t.value=null,b.length<j&&b.push(t)}function v(t,n,e){n||(n=0),"undefined"==typeof e&&(e=t?t.length:0);for(var r=-1,o=e-n||0,i=Array(0>o?0:o);++r<o;)i[r]=t[n+r];return i}function y(t){function n(t){return t&&"object"==typeof t&&!Xe(t)&&De.call(t,"__wrapped__")?t:new e(t)}function e(t,n){this.__chain__=!!n,this.__wrapped__=t}function r(t){function n(){if(r){var t=v(r);Ie.apply(t,arguments)}if(this instanceof n){var i=g(e.prototype),u=e.apply(i,t||arguments);return Rt(u)?u:i}return e.apply(o,t||arguments)}var e=t[0],r=t[2],o=t[4];return Je(n,t),n}function u(t,n,e,r,o){if(e){var i=e(t);if("undefined"!=typeof i)return i}var a=Rt(t);if(!a)return t;var c=Ce.call(t);if(!V[c])return t;var s=Ke[c];switch(c){case q:case Y:return new s(+t);case U:case H:return new s(t);case W:return i=s(t.source,O.exec(t)),i.lastIndex=t.lastIndex,i}var f=Xe(t);if(n){var p=!r;r||(r=l()),o||(o=l());for(var d=r.length;d--;)if(r[d]==t)return o[d];i=f?s(t.length):{}}else i=f?v(t):ir({},t);return f&&(De.call(t,"index")&&(i.index=t.index),De.call(t,"input")&&(i.input=t.input)),n?(r.push(t),o.push(i),(f?Gt:cr)(t,function(t,a){i[a]=u(t,n,e,r,o)}),p&&(h(r),h(o)),i):i}function g(t,n){return Rt(t)?qe(t):{}}function b(t,n,e){if("function"!=typeof t)return Xn;if("undefined"==typeof n||!("prototype"in t))return t;var r=t.__bindData__;if("undefined"==typeof r&&(Ge.funcNames&&(r=!t.name),r=r||!Ge.funcDecomp,!r)){var o=Ae.call(t);Ge.funcNames||(r=!R.test(o)),r||(r=D.test(o),Je(t,r))}if(r===!1||r!==!0&&1&r[1])return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)};case 4:return function(e,r,o,i){return t.call(n,e,r,o,i)}}return In(t,n)}function j(t){function n(){var t=c?u:this;if(o){var h=v(o);Ie.apply(h,arguments)}if((i||f)&&(h||(h=v(arguments)),i&&Ie.apply(h,i),f&&h.length<a))return r|=16,j([e,l?r:-4&r,h,null,u,a]);if(h||(h=arguments),s&&(e=t[p]),this instanceof n){t=g(e.prototype);var d=e.apply(t,h);return Rt(d)?d:t}return e.apply(t,h)}var e=t[0],r=t[1],o=t[2],i=t[3],u=t[4],a=t[5],c=1&r,s=2&r,f=4&r,l=8&r,p=e;return Je(n,t),n}function J(t,n){var e=-1,r=ct(),u=t?t.length:0,a=u>=_&&r===o,c=[];if(a){var f=s(n);f?(r=i,n=f):a=!1}for(;++e<u;){var l=t[e];r(n,l)<0&&c.push(l)}return a&&d(n),c}function Z(t,n,e,r){for(var o=(r||0)-1,i=t?t.length:0,u=[];++o<i;){var a=t[o];if(a&&"object"==typeof a&&"number"==typeof a.length&&(Xe(a)||pt(a))){n||(a=Z(a,n,e));var c=-1,s=a.length,f=u.length;for(u.length+=s;++c<s;)u[f++]=a[c]}else e||u.push(a)}return u}function tt(t,n,e,r,o,i){if(e){var u=e(t,n);if("undefined"!=typeof u)return!!u}if(t===n)return 0!==t||1/t==1/n;var a=typeof t,c=typeof n;if(!(t!==t||t&&G[a]||n&&G[c]))return!1;if(null==t||null==n)return t===n;var s=Ce.call(t),f=Ce.call(n);if(s==L&&(s=$),f==L&&(f=$),s!=f)return!1;switch(s){case q:case Y:return+t==+n;case U:return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case W:case H:return t==_e(n)}var p=s==P;if(!p){var d=De.call(t,"__wrapped__"),v=De.call(n,"__wrapped__");if(d||v)return tt(d?t.__wrapped__:t,v?n.__wrapped__:n,e,r,o,i);if(s!=$)return!1;var y=t.constructor,m=n.constructor;if(y!=m&&!(Ot(y)&&y instanceof y&&Ot(m)&&m instanceof m)&&"constructor"in t&&"constructor"in n)return!1}var g=!o;o||(o=l()),i||(i=l());for(var b=o.length;b--;)if(o[b]==t)return i[b]==n;var w=0;if(u=!0,o.push(t),i.push(n),p){if(b=t.length,w=n.length,u=w==b,u||r)for(;w--;){var k=b,_=n[w];if(r)for(;k--&&!(u=tt(t[k],_,e,r,o,i)););else if(!(u=tt(t[w],_,e,r,o,i)))break}}else ar(n,function(n,a,c){return De.call(c,a)?(w++,u=De.call(t,a)&&tt(t[a],n,e,r,o,i)):void 0}),u&&!r&&ar(t,function(t,n,e){return De.call(e,n)?u=--w>-1:void 0});return o.pop(),i.pop(),g&&(h(o),h(i)),u}function nt(t,n,e,r,o){(Xe(n)?Gt:cr)(n,function(n,i){var u,a,c=n,s=t[i];if(n&&((a=Xe(n))||sr(n))){for(var f=r.length;f--;)if(u=r[f]==n){s=o[f];break}if(!u){var l;e&&(c=e(s,n),(l="undefined"!=typeof c)&&(s=c)),l||(s=a?Xe(s)?s:[]:sr(s)?s:{}),r.push(n),o.push(s),l||nt(s,n,e,r,o)}}else e&&(c=e(s,n),"undefined"==typeof c&&(c=n)),"undefined"!=typeof c&&(s=c);t[i]=s})}function et(t,n){return t+Ne(Qe()*(n-t+1))}function ot(t,n,e){var r=-1,u=ct(),a=t?t.length:0,c=[],f=!n&&a>=_&&u===o,p=e||f?l():c;if(f){var v=s(p);u=i,p=v}for(;++r<a;){var y=t[r],m=e?e(y,r,t):y;(n?!r||p[p.length-1]!==m:u(p,m)<0)&&((e||f)&&p.push(m),c.push(y))}return f?(h(p.array),d(p)):e&&h(p),c}function it(t){return function(e,r,o){var i={};r=n.createCallback(r,o,3);var u=-1,a=e?e.length:0;if("number"==typeof a)for(;++u<a;){var c=e[u];t(i,c,r(c,u,e),e)}else cr(e,function(n,e,o){t(i,n,r(n,e,o),o)});return i}}function ut(t,n,e,o,i,u){var a=1&n,c=2&n,s=4&n,f=16&n,l=32&n;if(!c&&!Ot(t))throw new je;f&&!e.length&&(n&=-17,f=e=!1),l&&!o.length&&(n&=-33,l=o=!1);var p=t&&t.__bindData__;if(p&&p!==!0)return p=v(p),p[2]&&(p[2]=v(p[2])),p[3]&&(p[3]=v(p[3])),!a||1&p[1]||(p[4]=i),!a&&1&p[1]&&(n|=8),!s||4&p[1]||(p[5]=u),f&&Ie.apply(p[2]||(p[2]=[]),e),l&&Le.apply(p[3]||(p[3]=[]),o),p[1]|=n,ut.apply(null,p);var h=1==n||17===n?r:j;return h([t,n,e,o,i,u])}function at(t){return nr[t]}function ct(){var t=(t=n.indexOf)===gn?o:t;return t}function st(t){return"function"==typeof t&&Ee.test(t)}function ft(t){var n,e;return t&&Ce.call(t)==$&&(n=t.constructor,!Ot(n)||n instanceof n)?(ar(t,function(t,n){e=n}),"undefined"==typeof e||De.call(t,e)):!1}function lt(t){return er[t]}function pt(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Ce.call(t)==L||!1}function ht(t,n,e,r){return"boolean"!=typeof n&&null!=n&&(r=e,e=n,n=!1),u(t,n,"function"==typeof e&&b(e,r,1))}function dt(t,n,e){return u(t,!0,"function"==typeof n&&b(n,e,1))}function vt(t,n){var e=g(t);return n?ir(e,n):e}function yt(t,e,r){var o;return e=n.createCallback(e,r,3),cr(t,function(t,n,r){return e(t,n,r)?(o=n,!1):void 0}),o}function mt(t,e,r){var o;return e=n.createCallback(e,r,3),bt(t,function(t,n,r){return e(t,n,r)?(o=n,!1):void 0}),o}function gt(t,n,e){var r=[];ar(t,function(t,n){r.push(n,t)});var o=r.length;for(n=b(n,e,3);o--&&n(r[o--],r[o],t)!==!1;);return t}function bt(t,n,e){var r=tr(t),o=r.length;for(n=b(n,e,3);o--;){var i=r[o];if(n(t[i],i,t)===!1)break}return t}function wt(t){var n=[];return ar(t,function(t,e){Ot(t)&&n.push(e)}),n.sort()}function kt(t,n){return t?De.call(t,n):!1}function _t(t){for(var n=-1,e=tr(t),r=e.length,o={};++n<r;){var i=e[n];o[t[i]]=i}return o}function jt(t){return t===!0||t===!1||t&&"object"==typeof t&&Ce.call(t)==q||!1}function xt(t){return t&&"object"==typeof t&&Ce.call(t)==Y||!1}function St(t){return t&&1===t.nodeType||!1}function Tt(t){var n=!0;if(!t)return n;var e=Ce.call(t),r=t.length;return e==P||e==H||e==L||e==$&&"number"==typeof r&&Ot(t.splice)?!r:(cr(t,function(){return n=!1}),n)}function Ct(t,n,e,r){return tt(t,n,"function"==typeof e&&b(e,r,2))}function Et(t){return Fe(t)&&!Ue(parseFloat(t))}function Ot(t){return"function"==typeof t}function Rt(t){return!(!t||!G[typeof t])}function Nt(t){return Mt(t)&&t!=+t}function At(t){return null===t}function Mt(t){return"number"==typeof t||t&&"object"==typeof t&&Ce.call(t)==U||!1}function Dt(t){return t&&"object"==typeof t&&Ce.call(t)==W||!1}function It(t){return"string"==typeof t||t&&"object"==typeof t&&Ce.call(t)==H||!1}function zt(t){return"undefined"==typeof t}function Bt(t,e,r){var o={};return e=n.createCallback(e,r,3),cr(t,function(t,n,r){o[n]=e(t,n,r)}),o}function Lt(t){var n=arguments,e=2;if(!Rt(t))return t;if("number"!=typeof n[2]&&(e=n.length),e>3&&"function"==typeof n[e-2])var r=b(n[--e-1],n[e--],2);else e>2&&"function"==typeof n[e-1]&&(r=n[--e]);for(var o=v(arguments,1,e),i=-1,u=l(),a=l();++i<e;)nt(t,o[i],r,u,a);return h(u),h(a),t}function Pt(t,e,r){var o={};if("function"!=typeof e){var i=[];ar(t,function(t,n){i.push(n)}),i=J(i,Z(arguments,!0,!1,1));for(var u=-1,a=i.length;++u<a;){var c=i[u];o[c]=t[c]}}else e=n.createCallback(e,r,3),ar(t,function(t,n,r){e(t,n,r)||(o[n]=t)});return o}function qt(t){for(var n=-1,e=tr(t),r=e.length,o=de(r);++n<r;){var i=e[n];o[n]=[i,t[i]]}return o}function Yt(t,e,r){var o={};if("function"!=typeof e)for(var i=-1,u=Z(arguments,!0,!1,1),a=Rt(t)?u.length:0;++i<a;){var c=u[i];c in t&&(o[c]=t[c])}else e=n.createCallback(e,r,3),ar(t,function(t,n,r){e(t,n,r)&&(o[n]=t)});return o}function Ft(t,e,r,o){var i=Xe(t);if(null==r)if(i)r=[];else{var u=t&&t.constructor,a=u&&u.prototype;r=g(a)}return e&&(e=n.createCallback(e,o,4),(i?Gt:cr)(t,function(t,n,o){return e(r,t,n,o)})),r}function Ut(t){for(var n=-1,e=tr(t),r=e.length,o=de(r);++n<r;)o[n]=t[e[n]];return o}function $t(t){for(var n=arguments,e=-1,r=Z(n,!0,!1,1),o=n[2]&&n[2][n[1]]===t?1:r.length,i=de(o);++e<o;)i[e]=t[r[e]];return i}function Wt(t,n,e){var r=-1,o=ct(),i=t?t.length:0,u=!1;return e=(0>e?We(0,i+e):e)||0,Xe(t)?u=o(t,n,e)>-1:"number"==typeof i?u=(It(t)?t.indexOf(n,e):o(t,n,e))>-1:cr(t,function(t){return++r>=e?!(u=t===n):void 0}),u}function Ht(t,e,r){var o=!0;e=n.createCallback(e,r,3);var i=-1,u=t?t.length:0;if("number"==typeof u)for(;++i<u&&(o=!!e(t[i],i,t)););else cr(t,function(t,n,r){return o=!!e(t,n,r)});return o}function Vt(t,e,r){var o=[];e=n.createCallback(e,r,3);var i=-1,u=t?t.length:0;if("number"==typeof u)for(;++i<u;){var a=t[i];e(a,i,t)&&o.push(a)}else cr(t,function(t,n,r){e(t,n,r)&&o.push(t)});return o}function Qt(t,e,r){e=n.createCallback(e,r,3);var o=-1,i=t?t.length:0;if("number"!=typeof i){var u;return cr(t,function(t,n,r){return e(t,n,r)?(u=t,!1):void 0}),u}for(;++o<i;){var a=t[o];if(e(a,o,t))return a}}function Kt(t,e,r){var o;return e=n.createCallback(e,r,3),Jt(t,function(t,n,r){return e(t,n,r)?(o=t,!1):void 0}),o}function Gt(t,n,e){var r=-1,o=t?t.length:0;if(n=n&&"undefined"==typeof e?n:b(n,e,3),"number"==typeof o)for(;++r<o&&n(t[r],r,t)!==!1;);else cr(t,n);return t}function Jt(t,n,e){var r=t?t.length:0;if(n=n&&"undefined"==typeof e?n:b(n,e,3),"number"==typeof r)for(;r--&&n(t[r],r,t)!==!1;);else{var o=tr(t);r=o.length,cr(t,function(t,e,i){return e=o?o[--r]:--r,n(i[e],e,i)})}return t}function Xt(t,n){var e=v(arguments,2),r=-1,o="function"==typeof n,i=t?t.length:0,u=de("number"==typeof i?i:0);return Gt(t,function(t){u[++r]=(o?n:t[n]).apply(t,e)}),u}function Zt(t,e,r){var o=-1,i=t?t.length:0;if(e=n.createCallback(e,r,3),"number"==typeof i)for(var u=de(i);++o<i;)u[o]=e(t[o],o,t);else u=[],cr(t,function(t,n,r){u[++o]=e(t,n,r)});return u}function tn(t,e,r){var o=-(1/0),i=o;if("function"!=typeof e&&r&&r[e]===t&&(e=null),null==e&&Xe(t))for(var u=-1,c=t.length;++u<c;){var s=t[u];s>i&&(i=s)}else e=null==e&&It(t)?a:n.createCallback(e,r,3),Gt(t,function(t,n,r){var u=e(t,n,r);u>o&&(o=u,i=t)});return i}function nn(t,e,r){var o=1/0,i=o;if("function"!=typeof e&&r&&r[e]===t&&(e=null),null==e&&Xe(t))for(var u=-1,c=t.length;++u<c;){var s=t[u];i>s&&(i=s)}else e=null==e&&It(t)?a:n.createCallback(e,r,3),Gt(t,function(t,n,r){var u=e(t,n,r);o>u&&(o=u,i=t)});return i}function en(t,e,r,o){if(!t)return r;var i=arguments.length<3;e=n.createCallback(e,o,4);var u=-1,a=t.length;if("number"==typeof a)for(i&&(r=t[++u]);++u<a;)r=e(r,t[u],u,t);else cr(t,function(t,n,o){r=i?(i=!1,t):e(r,t,n,o)});return r}function rn(t,e,r,o){var i=arguments.length<3;return e=n.createCallback(e,o,4),Jt(t,function(t,n,o){r=i?(i=!1,t):e(r,t,n,o)}),r}function on(t,e,r){return e=n.createCallback(e,r,3),Vt(t,function(t,n,r){return!e(t,n,r)})}function un(t,n,e){if(t&&"number"!=typeof t.length&&(t=Ut(t)),null==n||e)return t?t[et(0,t.length-1)]:m;var r=an(t);return r.length=He(We(0,n),r.length),r}function an(t){var n=-1,e=t?t.length:0,r=de("number"==typeof e?e:0);return Gt(t,function(t){var e=et(0,++n);r[n]=r[e],r[e]=t}),r}function cn(t){var n=t?t.length:0;return"number"==typeof n?n:tr(t).length}function sn(t,e,r){var o;e=n.createCallback(e,r,3);var i=-1,u=t?t.length:0;if("number"==typeof u)for(;++i<u&&!(o=e(t[i],i,t)););else cr(t,function(t,n,r){return!(o=e(t,n,r))});return!!o}function fn(t,e,r){var o=-1,i=Xe(e),u=t?t.length:0,a=de("number"==typeof u?u:0);for(i||(e=n.createCallback(e,r,3)),Gt(t,function(t,n,r){var u=a[++o]=p();i?u.criteria=Zt(e,function(n){return t[n]}):(u.criteria=l())[0]=e(t,n,r),u.index=o,u.value=t}),u=a.length,a.sort(c);u--;){var s=a[u];a[u]=s.value,i||h(s.criteria),d(s)}return a}function ln(t){return t&&"number"==typeof t.length?v(t):Ut(t)}function pn(t){for(var n=-1,e=t?t.length:0,r=[];++n<e;){var o=t[n];o&&r.push(o)}return r}function hn(t){return J(t,Z(arguments,!0,!0,1))}function dn(t,e,r){var o=-1,i=t?t.length:0;for(e=n.createCallback(e,r,3);++o<i;)if(e(t[o],o,t))return o;return-1}function vn(t,e,r){var o=t?t.length:0;for(e=n.createCallback(e,r,3);o--;)if(e(t[o],o,t))return o;return-1}function yn(t,e,r){var o=0,i=t?t.length:0;if("number"!=typeof e&&null!=e){var u=-1;for(e=n.createCallback(e,r,3);++u<i&&e(t[u],u,t);)o++}else if(o=e,null==o||r)return t?t[0]:m;return v(t,0,He(We(0,o),i))}function mn(t,n,e,r){return"boolean"!=typeof n&&null!=n&&(r=e,e="function"!=typeof n&&r&&r[n]===t?null:n,n=!1),null!=e&&(t=Zt(t,e,r)),Z(t,n)}function gn(t,n,e){if("number"==typeof e){var r=t?t.length:0;e=0>e?We(0,r+e):e||0}else if(e){var i=Cn(t,n);return t[i]===n?i:-1}return o(t,n,e)}function bn(t,e,r){var o=0,i=t?t.length:0;if("number"!=typeof e&&null!=e){var u=i;for(e=n.createCallback(e,r,3);u--&&e(t[u],u,t);)o++}else o=null==e||r?1:e||o;return v(t,0,He(We(0,i-o),i))}function wn(){for(var t=[],n=-1,e=arguments.length,r=l(),u=ct(),a=u===o,c=l();++n<e;){var f=arguments[n];(Xe(f)||pt(f))&&(t.push(f),r.push(a&&f.length>=_&&s(n?t[n]:c)))}var p=t[0],v=-1,y=p?p.length:0,m=[];t:for(;++v<y;){var g=r[0];if(f=p[v],(g?i(g,f):u(c,f))<0){for(n=e,(g||c).push(f);--n;)if(g=r[n],(g?i(g,f):u(t[n],f))<0)continue t;m.push(f)}}for(;e--;)g=r[e],g&&d(g);return h(r),h(c),m}function kn(t,e,r){var o=0,i=t?t.length:0;if("number"!=typeof e&&null!=e){var u=i;for(e=n.createCallback(e,r,3);u--&&e(t[u],u,t);)o++}else if(o=e,null==o||r)return t?t[i-1]:m;return v(t,We(0,i-o))}function _n(t,n,e){var r=t?t.length:0;for("number"==typeof e&&(r=(0>e?We(0,r+e):He(e,r-1))+1);r--;)if(t[r]===n)return r;return-1}function jn(t){for(var n=arguments,e=0,r=n.length,o=t?t.length:0;++e<r;)for(var i=-1,u=n[e];++i<o;)t[i]===u&&(Be.call(t,i--,1),o--);return t}function xn(t,n,e){t=+t||0,e="number"==typeof e?e:+e||1,null==n&&(n=t,t=0);for(var r=-1,o=We(0,Oe((n-t)/(e||1))),i=de(o);++r<o;)i[r]=t,t+=e;return i}function Sn(t,e,r){var o=-1,i=t?t.length:0,u=[];for(e=n.createCallback(e,r,3);++o<i;){var a=t[o];e(a,o,t)&&(u.push(a),Be.call(t,o--,1),i--)}return u}function Tn(t,e,r){if("number"!=typeof e&&null!=e){var o=0,i=-1,u=t?t.length:0;for(e=n.createCallback(e,r,3);++i<u&&e(t[i],i,t);)o++}else o=null==e||r?1:We(0,e);return v(t,o)}function Cn(t,e,r,o){var i=0,u=t?t.length:i;for(r=r?n.createCallback(r,o,1):Xn,e=r(e);u>i;){var a=i+u>>>1;r(t[a])<e?i=a+1:u=a}return i}function En(){return ot(Z(arguments,!0,!0))}function On(t,e,r,o){return"boolean"!=typeof e&&null!=e&&(o=r,r="function"!=typeof e&&o&&o[e]===t?null:e,e=!1),null!=r&&(r=n.createCallback(r,o,3)),ot(t,e,r)}function Rn(t){return J(t,v(arguments,1))}function Nn(){for(var t=-1,n=arguments.length;++t<n;){var e=arguments[t];if(Xe(e)||pt(e))var r=r?ot(J(r,e).concat(J(e,r))):e}return r||[]}function An(){for(var t=arguments.length>1?arguments:arguments[0],n=-1,e=t?tn(hr(t,"length")):0,r=de(0>e?0:e);++n<e;)r[n]=hr(t,n);return r}function Mn(t,n){var e=-1,r=t?t.length:0,o={};for(n||!r||Xe(t[0])||(n=[]);++e<r;){var i=t[e];n?o[i]=n[e]:i&&(o[i[0]]=i[1])}return o}function Dn(t,n){if(!Ot(n))throw new je;return function(){return--t<1?n.apply(this,arguments):void 0}}function In(t,n){return arguments.length>2?ut(t,17,v(arguments,2),null,n):ut(t,1,null,null,n)}function zn(t){for(var n=arguments.length>1?Z(arguments,!0,!1,1):wt(t),e=-1,r=n.length;++e<r;){var o=n[e];t[o]=ut(t[o],1,null,null,t)}return t}function Bn(t,n){return arguments.length>2?ut(n,19,v(arguments,2),null,t):ut(n,3,null,null,t)}function Ln(){for(var t=arguments,n=t.length;n--;)if(!Ot(t[n]))throw new je;return function(){for(var n=arguments,e=t.length;e--;)n=[t[e].apply(this,n)];return n[0]}}function Pn(t,n){return n="number"==typeof n?n:+n||t.length,ut(t,4,null,null,null,n)}function qn(t,n,e){var r,o,i,u,a,c,s,f=0,l=!1,p=!0;if(!Ot(t))throw new je;if(n=We(0,n)||0,e===!0){var h=!0;p=!1}else Rt(e)&&(h=e.leading,l="maxWait"in e&&(We(n,e.maxWait)||0),p="trailing"in e?e.trailing:p);var d=function(){var e=n-(vr()-u);if(0>=e){o&&Re(o);var l=s;o=c=s=m,l&&(f=vr(),i=t.apply(a,r),c||o||(r=a=null))}else c=ze(d,e)},v=function(){c&&Re(c),o=c=s=m,(p||l!==n)&&(f=vr(),i=t.apply(a,r),c||o||(r=a=null))};return function(){if(r=arguments,u=vr(),a=this,s=p&&(c||!h),l===!1)var e=h&&!c;else{o||h||(f=u);var y=l-(u-f),m=0>=y;m?(o&&(o=Re(o)),f=u,i=t.apply(a,r)):o||(o=ze(v,y))}return m&&c?c=Re(c):c||n===l||(c=ze(d,n)),e&&(m=!0,i=t.apply(a,r)),!m||c||o||(r=a=null),i}}function Yn(t){if(!Ot(t))throw new je;var n=v(arguments,1);return ze(function(){t.apply(m,n)},1)}function Fn(t,n){if(!Ot(t))throw new je;var e=v(arguments,2);return ze(function(){t.apply(m,e)},n)}function Un(t,n){if(!Ot(t))throw new je;var e=function(){var r=e.cache,o=n?n.apply(this,arguments):k+arguments[0];return De.call(r,o)?r[o]:r[o]=t.apply(this,arguments)};return e.cache={},e}function $n(t){var n,e;if(!Ot(t))throw new je;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}}function Wn(t){return ut(t,16,v(arguments,1))}function Hn(t){return ut(t,32,null,v(arguments,1))}function Vn(t,n,e){var r=!0,o=!0;if(!Ot(t))throw new je;return e===!1?r=!1:Rt(e)&&(r="leading"in e?e.leading:r,o="trailing"in e?e.trailing:o),Q.leading=r,Q.maxWait=n,Q.trailing=o,qn(t,n,Q)}function Qn(t,n){return ut(n,16,[t])}function Kn(t){return function(){return t}}function Gn(t,n,e){var r=typeof t;if(null==t||"function"==r)return b(t,n,e);if("object"!=r)return ee(t);var o=tr(t),i=o[0],u=t[i];return 1!=o.length||u!==u||Rt(u)?function(n){for(var e=o.length,r=!1;e--&&(r=tt(n[o[e]],t[o[e]],null,!0)););return r}:function(t){var n=t[i];return u===n&&(0!==u||1/u==1/n)}}function Jn(t){return null==t?"":_e(t).replace(or,at)}function Xn(t){return t}function Zn(t,r,o){var i=!0,u=r&&wt(r);r&&(o||u.length)||(null==o&&(o=r),a=e,r=t,t=n,u=wt(r)),o===!1?i=!1:Rt(o)&&"chain"in o&&(i=o.chain);var a=t,c=Ot(a);Gt(u,function(n){var e=t[n]=r[n];c&&(a.prototype[n]=function(){var n=this.__chain__,r=this.__wrapped__,o=[r];Ie.apply(o,arguments);var u=e.apply(t,o);if(i||n){if(r===u&&Rt(u))return this;u=new a(u),u.__chain__=n}return u})})}function te(){return t._=Te,this}function ne(){}function ee(t){return function(n){return n[t]}}function re(t,n,e){var r=null==t,o=null==n;if(null==e&&("boolean"==typeof t&&o?(e=t,t=1):o||"boolean"!=typeof n||(e=n,o=!0)),r&&o&&(n=1),t=+t||0,o?(n=t,t=0):n=+n||0,e||t%1||n%1){var i=Qe();return He(t+i*(n-t+parseFloat("1e-"+((i+"").length-1))),n)}return et(t,n)}function oe(t,n){if(t){var e=t[n];return Ot(e)?t[n]():e}}function ie(t,e,r){var o=n.templateSettings;t=_e(t||""),r=ur({},r,o);var i,u=ur({},r.imports,o.imports),a=tr(u),c=Ut(u),s=0,l=r.interpolate||M,p="__p += '",h=ke((r.escape||M).source+"|"+l.source+"|"+(l===N?E:M).source+"|"+(r.evaluate||M).source+"|$","g");t.replace(h,function(n,e,r,o,u,a){return r||(r=o),p+=t.slice(s,a).replace(I,f),e&&(p+="' +\n__e("+e+") +\n'"),u&&(i=!0,p+="';\n"+u+";\n__p += '"),r&&(p+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),s=a+n.length,n}),p+="';\n";var d=r.variable,v=d;v||(d="obj",p="with ("+d+") {\n"+p+"\n}\n"),p=(i?p.replace(S,""):p).replace(T,"$1").replace(C,"$1;"),p="function("+d+") {\n"+(v?"":d+" || ("+d+" = {});\n")+"var __t, __p = '', __e = _.escape"+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var y="\n/*\n//# sourceURL="+(r.sourceURL||"/lodash/template/source["+B++ +"]")+"\n*/";try{var g=me(a,"return "+p+y).apply(m,c)}catch(b){throw b.source=p,b}return e?g(e):(g.source=p,g)}function ue(t,n,e){t=(t=+t)>-1?t:0;var r=-1,o=de(t);for(n=b(n,e,1);++r<t;)o[r]=n(r);return o}function ae(t){return null==t?"":_e(t).replace(rr,lt)}function ce(t){var n=++w;return _e(null==t?"":t)+n}function se(t){return t=new e(t),t.__chain__=!0,t}function fe(t,n){return n(t),t}function le(){return this.__chain__=!0,this}function pe(){return _e(this.__wrapped__)}function he(){return this.__wrapped__}t=t?rt.defaults(X.Object(),t,rt.pick(X,z)):X;var de=t.Array,ve=t.Boolean,ye=t.Date,me=t.Function,ge=t.Math,be=t.Number,we=t.Object,ke=t.RegExp,_e=t.String,je=t.TypeError,xe=[],Se=we.prototype,Te=t._,Ce=Se.toString,Ee=ke("^"+_e(Ce).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Oe=ge.ceil,Re=t.clearTimeout,Ne=ge.floor,Ae=me.prototype.toString,Me=st(Me=we.getPrototypeOf)&&Me,De=Se.hasOwnProperty,Ie=xe.push,ze=t.setTimeout,Be=xe.splice,Le=xe.unshift,Pe=function(){try{var t={},n=st(n=we.defineProperty)&&n,e=n(t,t,t)&&n}catch(r){}return e}(),qe=st(qe=we.create)&&qe,Ye=st(Ye=de.isArray)&&Ye,Fe=t.isFinite,Ue=t.isNaN,$e=st($e=we.keys)&&$e,We=ge.max,He=ge.min,Ve=t.parseInt,Qe=ge.random,Ke={};Ke[P]=de,Ke[q]=ve,Ke[Y]=ye,Ke[F]=me,Ke[$]=we,Ke[U]=be,Ke[W]=ke,Ke[H]=_e,e.prototype=n.prototype;var Ge=n.support={};Ge.funcDecomp=!st(t.WinRTError)&&D.test(y),Ge.funcNames="string"==typeof me.name,n.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:N,variable:"",imports:{_:n}},qe||(g=function(){function n(){}return function(e){if(Rt(e)){n.prototype=e;var r=new n;n.prototype=null}return r||t.Object()}}());var Je=Pe?function(t,n){K.value=n,Pe(t,"__bindData__",K)}:ne,Xe=Ye||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Ce.call(t)==P||!1},Ze=function(t){var n,e=t,r=[];if(!e)return r;if(!G[typeof t])return r;for(n in e)De.call(e,n)&&r.push(n);return r},tr=$e?function(t){return Rt(t)?$e(t):[]}:Ze,nr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},er=_t(nr),rr=ke("("+tr(er).join("|")+")","g"),or=ke("["+tr(nr).join("")+"]","g"),ir=function(t,n,e){var r,o=t,i=o;if(!o)return i;var u=arguments,a=0,c="number"==typeof e?2:u.length;if(c>3&&"function"==typeof u[c-2])var s=b(u[--c-1],u[c--],2);else c>2&&"function"==typeof u[c-1]&&(s=u[--c]);for(;++a<c;)if(o=u[a],o&&G[typeof o])for(var f=-1,l=G[typeof o]&&tr(o),p=l?l.length:0;++f<p;)r=l[f],i[r]=s?s(i[r],o[r]):o[r];return i},ur=function(t,n,e){var r,o=t,i=o;if(!o)return i;for(var u=arguments,a=0,c="number"==typeof e?2:u.length;++a<c;)if(o=u[a],o&&G[typeof o])for(var s=-1,f=G[typeof o]&&tr(o),l=f?f.length:0;++s<l;)r=f[s],"undefined"==typeof i[r]&&(i[r]=o[r]);return i},ar=function(t,n,e){var r,o=t,i=o;if(!o)return i;if(!G[typeof o])return i;n=n&&"undefined"==typeof e?n:b(n,e,3);for(r in o)if(n(o[r],r,t)===!1)return i;return i},cr=function(t,n,e){var r,o=t,i=o;if(!o)return i;if(!G[typeof o])return i;n=n&&"undefined"==typeof e?n:b(n,e,3);for(var u=-1,a=G[typeof o]&&tr(o),c=a?a.length:0;++u<c;)if(r=a[u],n(o[r],r,t)===!1)return i;return i},sr=Me?function(t){if(!t||Ce.call(t)!=$)return!1;var n=t.valueOf,e=st(n)&&(e=Me(n))&&Me(e);return e?t==e||Me(t)==e:ft(t)}:ft,fr=it(function(t,n,e){De.call(t,e)?t[e]++:t[e]=1}),lr=it(function(t,n,e){(De.call(t,e)?t[e]:t[e]=[]).push(n)}),pr=it(function(t,n,e){t[e]=n}),hr=Zt,dr=Vt,vr=st(vr=ye.now)&&vr||function(){return(new ye).getTime()},yr=8==Ve(x+"08")?Ve:function(t,n){return Ve(It(t)?t.replace(A,""):t,n||0)};return n.after=Dn,n.assign=ir,n.at=$t,n.bind=In,n.bindAll=zn,n.bindKey=Bn,n.chain=se,n.compact=pn,n.compose=Ln,n.constant=Kn,n.countBy=fr,n.create=vt,n.createCallback=Gn,n.curry=Pn,n.debounce=qn,n.defaults=ur,n.defer=Yn,n.delay=Fn,n.difference=hn,n.filter=Vt,n.flatten=mn,n.forEach=Gt,n.forEachRight=Jt,n.forIn=ar,n.forInRight=gt,n.forOwn=cr,n.forOwnRight=bt,n.functions=wt,n.groupBy=lr,n.indexBy=pr,n.initial=bn,n.intersection=wn,n.invert=_t,n.invoke=Xt,n.keys=tr,n.map=Zt,n.mapValues=Bt,n.max=tn,n.memoize=Un,n.merge=Lt,n.min=nn,n.omit=Pt,n.once=$n,n.pairs=qt,n.partial=Wn,n.partialRight=Hn,n.pick=Yt,n.pluck=hr,n.property=ee,n.pull=jn,n.range=xn,n.reject=on,n.remove=Sn,n.rest=Tn,n.shuffle=an,n.sortBy=fn,n.tap=fe,n.throttle=Vn,n.times=ue,n.toArray=ln,n.transform=Ft,n.union=En,n.uniq=On,n.values=Ut,n.where=dr,n.without=Rn,n.wrap=Qn,n.xor=Nn,n.zip=An,n.zipObject=Mn,n.collect=Zt,n.drop=Tn,n.each=Gt,n.eachRight=Jt,n.extend=ir,n.methods=wt,n.object=Mn,n.select=Vt,n.tail=Tn,n.unique=On,n.unzip=An,Zn(n),n.clone=ht,n.cloneDeep=dt,n.contains=Wt,n.escape=Jn,n.every=Ht,n.find=Qt,n.findIndex=dn,n.findKey=yt,n.findLast=Kt,n.findLastIndex=vn,n.findLastKey=mt,n.has=kt,n.identity=Xn,n.indexOf=gn,n.isArguments=pt,n.isArray=Xe,n.isBoolean=jt,n.isDate=xt,n.isElement=St,n.isEmpty=Tt,n.isEqual=Ct,n.isFinite=Et,n.isFunction=Ot,n.isNaN=Nt,n.isNull=At,n.isNumber=Mt,n.isObject=Rt,n.isPlainObject=sr,n.isRegExp=Dt,n.isString=It,n.isUndefined=zt,n.lastIndexOf=_n,n.mixin=Zn,n.noConflict=te,n.noop=ne,n.now=vr,n.parseInt=yr,n.random=re,n.reduce=en,n.reduceRight=rn,n.result=oe,n.runInContext=y,n.size=cn,n.some=sn,n.sortedIndex=Cn,n.template=ie,n.unescape=ae,n.uniqueId=ce,n.all=Ht,n.any=sn,n.detect=Qt,n.findWhere=Qt,n.foldl=en,n.foldr=rn,n.include=Wt,n.inject=en,Zn(function(){var t={};return cr(n,function(e,r){n.prototype[r]||(t[r]=e)}),t}(),!1),n.first=yn,n.last=kn,n.sample=un,n.take=yn,n.head=yn,cr(n,function(t,r){var o="sample"!==r;n.prototype[r]||(n.prototype[r]=function(n,r){var i=this.__chain__,u=t(this.__wrapped__,n,r);return i||null!=n&&(!r||o&&"function"==typeof n)?new e(u,i):u})}),n.VERSION="2.4.1",n.prototype.chain=le,n.prototype.toString=pe,n.prototype.value=he,n.prototype.valueOf=he,Gt(["join","pop","shift"],function(t){var r=xe[t];n.prototype[t]=function(){var t=this.__chain__,n=r.apply(this.__wrapped__,arguments);return t?new e(n,t):n}}),Gt(["push","reverse","sort","unshift"],function(t){var e=xe[t];n.prototype[t]=function(){return e.apply(this.__wrapped__,arguments),this}}),Gt(["concat","slice","splice"],function(t){var r=xe[t];n.prototype[t]=function(){return new e(r.apply(this.__wrapped__,arguments),this.__chain__)}}),n}var m,g=[],b=[],w=0,k=+new Date+"",_=75,j=40,x=" 	\f \ufeff\n\r\u2028\u2029 ᠎             　",S=/\b__p \+= '';/g,T=/\b(__p \+=) '' \+/g,C=/(__e\(.*?\)|\b__t\)) \+\n'';/g,E=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,O=/\w*$/,R=/^\s*function[ \n\r\t]+\w/,N=/<%=([\s\S]+?)%>/g,A=RegExp("^["+x+"]*0+(?=.$)"),M=/($^)/,D=/\bthis\b/,I=/['\n\r\t\u2028\u2029\\]/g,z=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],B=0,L="[object Arguments]",P="[object Array]",q="[object Boolean]",Y="[object Date]",F="[object Function]",U="[object Number]",$="[object Object]",W="[object RegExp]",H="[object String]",V={};V[F]=!1,V[L]=V[P]=V[q]=V[Y]=V[U]=V[$]=V[W]=V[H]=!0;var Q={leading:!1,maxWait:0,trailing:!1},K={configurable:!1,enumerable:!1,value:null,writable:!1},G={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},J={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},X=G[typeof window]&&window||this,Z=G[typeof r]&&r&&!r.nodeType&&r,tt=G[typeof e]&&e&&!e.nodeType&&e,nt=tt&&tt.exports===Z&&Z,et=G[typeof n]&&n;!et||et.global!==et&&et.window!==et||(X=et);var rt=y();"function"==typeof t&&"object"==typeof t.amd&&t.amd?(X._=rt,t(function(){return rt})):Z&&tt?nt?(tt.exports=rt)._=rt:Z._=rt:X._=rt}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(n,e,r){(function(n){/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
!function(n){"use strict";if("function"==typeof bootstrap)bootstrap("promise",n);else if("object"==typeof r&&"object"==typeof e)e.exports=n();else if("function"==typeof t&&t.amd)t(n);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=n}else{if("undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");self.Q=n()}}(function(){"use strict";function t(t){return function(){return K.apply(t,arguments)}}function e(t){return t===Object(t)}function r(t){return"[object StopIteration]"===rt(t)||t instanceof W}function o(t,n){if(F&&n.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(ot)){for(var e=[],r=n;r;r=r.source)r.stack&&e.unshift(r.stack);e.unshift(t.stack);var o=e.join("\n"+ot+"\n");t.stack=i(o)}}function i(t){for(var n=t.split("\n"),e=[],r=0;r<n.length;++r){var o=n[r];c(o)||u(o)||!o||e.push(o)}return e.join("\n")}function u(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function a(t){var n=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(n)return[n[1],Number(n[2])];var e=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(e)return[e[1],Number(e[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function c(t){var n=a(t);if(!n)return!1;var e=n[0],r=n[1];return e===$&&r>=H&&st>=r}function s(){if(F)try{throw new Error}catch(t){var n=t.stack.split("\n"),e=n[0].indexOf("@")>0?n[1]:n[2],r=a(e);if(!r)return;return $=r[0],r[1]}}function f(t,n,e){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn,t.apply(t,arguments)}}function l(t){return t instanceof v?t:b(t)?E(t):C(t)}function p(){function t(t){n=t,i.source=t,J(e,function(n,e){l.nextTick(function(){t.promiseDispatch.apply(t,e)})},void 0),e=void 0,r=void 0}var n,e=[],r=[],o=tt(p.prototype),i=tt(v.prototype);if(i.promiseDispatch=function(t,o,i){var u=G(arguments);e?(e.push(u),"when"===o&&i[1]&&r.push(i[1])):l.nextTick(function(){n.promiseDispatch.apply(n,u)})},i.valueOf=function(){if(e)return i;var t=m(n);return g(t)&&(n=t),t},i.inspect=function(){return n?n.inspect():{state:"pending"}},l.longStackSupport&&F)try{throw new Error}catch(u){i.stack=u.stack.substring(u.stack.indexOf("\n")+1)}return o.promise=i,o.resolve=function(e){n||t(l(e))},o.fulfill=function(e){n||t(C(e))},o.reject=function(e){n||t(T(e))},o.notify=function(t){n||J(r,function(n,e){l.nextTick(function(){e(t)})},void 0)},o}function h(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var n=p();try{t(n.resolve,n.reject,n.notify)}catch(e){n.reject(e)}return n.promise}function d(t){return h(function(n,e){for(var r=0,o=t.length;o>r;r++)l(t[r]).then(n,e)})}function v(t,n,e){void 0===n&&(n=function(t){return T(new Error("Promise does not support operation: "+t))}),void 0===e&&(e=function(){return{state:"unknown"}});var r=tt(v.prototype);if(r.promiseDispatch=function(e,o,i){var u;try{u=t[o]?t[o].apply(r,i):n.call(r,o,i)}catch(a){u=T(a)}e&&e(u)},r.inspect=e,e){var o=e();"rejected"===o.state&&(r.exception=o.reason),r.valueOf=function(){var t=e();return"pending"===t.state||"rejected"===t.state?r:t.value}}return r}function y(t,n,e,r){return l(t).then(n,e,r)}function m(t){if(g(t)){var n=t.inspect();if("fulfilled"===n.state)return n.value}return t}function g(t){return t instanceof v}function b(t){return e(t)&&"function"==typeof t.then}function w(t){return g(t)&&"pending"===t.inspect().state}function k(t){return!g(t)||"fulfilled"===t.inspect().state}function _(t){return g(t)&&"rejected"===t.inspect().state}function j(){it.length=0,ut.length=0,ct||(ct=!0)}function x(t,e){ct&&("object"==typeof n&&"function"==typeof n.emit&&l.nextTick.runAfter(function(){-1!==X(ut,t)&&(n.emit("unhandledRejection",e,t),at.push(t))}),ut.push(t),it.push(e&&"undefined"!=typeof e.stack?e.stack:"(no stack) "+e))}function S(t){if(ct){var e=X(ut,t);-1!==e&&("object"==typeof n&&"function"==typeof n.emit&&l.nextTick.runAfter(function(){var r=X(at,t);-1!==r&&(n.emit("rejectionHandled",it[e],t),at.splice(r,1))}),ut.splice(e,1),it.splice(e,1))}}function T(t){var n=v({when:function(n){return n&&S(this),n?n(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return x(n,t),n}function C(t){return v({when:function(){return t},get:function(n){return t[n]},set:function(n,e){t[n]=e},"delete":function(n){delete t[n]},post:function(n,e){return null===n||void 0===n?t.apply(void 0,e):t[n].apply(t,e)},apply:function(n,e){return t.apply(n,e)},keys:function(){return et(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function E(t){var n=p();return l.nextTick(function(){try{t.then(n.resolve,n.reject,n.notify)}catch(e){n.reject(e)}}),n.promise}function O(t){return v({isDef:function(){}},function(n,e){return I(t,n,e)},function(){return l(t).inspect()})}function R(t,n,e){return l(t).spread(n,e)}function N(t){return function(){function n(t,n){var u;if("undefined"==typeof StopIteration){try{u=e[t](n)}catch(a){return T(a)}return u.done?l(u.value):y(u.value,o,i)}try{u=e[t](n)}catch(a){return r(a)?l(a.value):T(a)}return y(u,o,i)}var e=t.apply(this,arguments),o=n.bind(n,"next"),i=n.bind(n,"throw");return o()}}function A(t){l.done(l.async(t)())}function M(t){throw new W(t)}function D(t){return function(){return R([this,z(arguments)],function(n,e){return t.apply(n,e)})}}function I(t,n,e){return l(t).dispatch(n,e)}function z(t){return y(t,function(t){var n=0,e=p();return J(t,function(r,o,i){var u;g(o)&&"fulfilled"===(u=o.inspect()).state?t[i]=u.value:(++n,y(o,function(r){t[i]=r,0===--n&&e.resolve(t)},e.reject,function(t){e.notify({index:i,value:t})}))},void 0),0===n&&e.resolve(t),e.promise})}function B(t){if(0===t.length)return l.resolve();var n=l.defer(),e=0;return J(t,function(r,o,i){function u(t){n.resolve(t)}function a(){e--,0===e&&n.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function c(t){n.notify({index:i,value:t})}var s=t[i];e++,y(s,u,a,c)},void 0),n.promise}function L(t){return y(t,function(t){return t=Z(t,l),y(z(Z(t,function(t){return y(t,V,V)})),function(){return t})})}function P(t){return l(t).allSettled()}function q(t,n){return l(t).then(void 0,void 0,n)}function Y(t,n){return l(t).nodeify(n)}var F=!1;try{throw new Error}catch(U){F=!!U.stack}var $,W,H=s(),V=function(){},Q=function(){function t(){for(var t,n;r.next;)r=r.next,t=r.task,r.task=void 0,n=r.domain,n&&(r.domain=void 0,n.enter()),e(t,n);for(;c.length;)t=c.pop(),e(t);i=!1}function e(n,e){try{n()}catch(r){if(a)throw e&&e.exit(),setTimeout(t,0),e&&e.enter(),r;setTimeout(function(){throw r},0)}e&&e.exit()}var r={task:void 0,next:null},o=r,i=!1,u=void 0,a=!1,c=[];if(Q=function(t){o=o.next={task:t,domain:a&&n.domain,next:null},i||(i=!0,u())},"object"==typeof n&&"[object process]"===n.toString()&&n.nextTick)a=!0,u=function(){n.nextTick(t)};else if("function"==typeof setImmediate)u="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var s=new MessageChannel;s.port1.onmessage=function(){u=f,s.port1.onmessage=t,t()};var f=function(){s.port2.postMessage(0)};u=function(){setTimeout(t,0),f()}}else u=function(){setTimeout(t,0)};return Q.runAfter=function(t){c.push(t),i||(i=!0,u())},Q}(),K=Function.call,G=t(Array.prototype.slice),J=t(Array.prototype.reduce||function(t,n){var e=0,r=this.length;if(1===arguments.length)for(;;){if(e in this){n=this[e++];break}if(++e>=r)throw new TypeError}for(;r>e;e++)e in this&&(n=t(n,this[e],e));return n}),X=t(Array.prototype.indexOf||function(t){for(var n=0;n<this.length;n++)if(this[n]===t)return n;return-1}),Z=t(Array.prototype.map||function(t,n){var e=this,r=[];return J(e,function(o,i,u){r.push(t.call(n,i,u,e))},void 0),r}),tt=Object.create||function(t){function n(){}return n.prototype=t,new n},nt=t(Object.prototype.hasOwnProperty),et=Object.keys||function(t){var n=[];for(var e in t)nt(t,e)&&n.push(e);return n},rt=t(Object.prototype.toString);W="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var ot="From previous event:";l.resolve=l,l.nextTick=Q,l.longStackSupport=!1,"object"==typeof n&&n&&n.env&&n.env.Q_DEBUG&&(l.longStackSupport=!0),l.defer=p,p.prototype.makeNodeResolver=function(){var t=this;return function(n,e){n?t.reject(n):t.resolve(arguments.length>2?G(arguments,1):e)}},l.Promise=h,l.promise=h,h.race=d,h.all=z,h.reject=T,h.resolve=l,l.passByCopy=function(t){return t},v.prototype.passByCopy=function(){return this},l.join=function(t,n){return l(t).join(n)},v.prototype.join=function(t){return l([this,t]).spread(function(t,n){if(t===n)return t;throw new Error("Can't join: not the same: "+t+" "+n)})},l.race=d,v.prototype.race=function(){return this.then(l.race)},l.makePromise=v,v.prototype.toString=function(){return"[object Promise]"},v.prototype.then=function(t,n,e){function r(n){try{return"function"==typeof t?t(n):n}catch(e){return T(e)}}function i(t){if("function"==typeof n){o(t,a);try{return n(t)}catch(e){return T(e)}}return T(t)}function u(t){return"function"==typeof e?e(t):t}var a=this,c=p(),s=!1;return l.nextTick(function(){a.promiseDispatch(function(t){s||(s=!0,c.resolve(r(t)))},"when",[function(t){s||(s=!0,c.resolve(i(t)))}])}),a.promiseDispatch(void 0,"when",[void 0,function(t){var n,e=!1;try{n=u(t)}catch(r){if(e=!0,!l.onerror)throw r;l.onerror(r)}e||c.notify(n)}]),c.promise},l.tap=function(t,n){return l(t).tap(n)},v.prototype.tap=function(t){return t=l(t),this.then(function(n){return t.fcall(n).thenResolve(n)})},l.when=y,v.prototype.thenResolve=function(t){return this.then(function(){return t})},l.thenResolve=function(t,n){return l(t).thenResolve(n)},v.prototype.thenReject=function(t){return this.then(function(){throw t})},l.thenReject=function(t,n){return l(t).thenReject(n)},l.nearer=m,l.isPromise=g,l.isPromiseAlike=b,l.isPending=w,v.prototype.isPending=function(){return"pending"===this.inspect().state},l.isFulfilled=k,v.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},l.isRejected=_,v.prototype.isRejected=function(){return"rejected"===this.inspect().state};var it=[],ut=[],at=[],ct=!0;l.resetUnhandledRejections=j,l.getUnhandledReasons=function(){return it.slice()},l.stopUnhandledRejectionTracking=function(){j(),ct=!1},j(),l.reject=T,l.fulfill=C,l.master=O,l.spread=R,v.prototype.spread=function(t,n){return this.all().then(function(n){return t.apply(void 0,n)},n)},l.async=N,l.spawn=A,l["return"]=M,l.promised=D,l.dispatch=I,v.prototype.dispatch=function(t,n){var e=this,r=p();return l.nextTick(function(){e.promiseDispatch(r.resolve,t,n)}),r.promise},l.get=function(t,n){return l(t).dispatch("get",[n])},v.prototype.get=function(t){return this.dispatch("get",[t])},l.set=function(t,n,e){return l(t).dispatch("set",[n,e])},v.prototype.set=function(t,n){return this.dispatch("set",[t,n])},l.del=l["delete"]=function(t,n){return l(t).dispatch("delete",[n])},v.prototype.del=v.prototype["delete"]=function(t){return this.dispatch("delete",[t])},l.mapply=l.post=function(t,n,e){return l(t).dispatch("post",[n,e])},v.prototype.mapply=v.prototype.post=function(t,n){return this.dispatch("post",[t,n])},l.send=l.mcall=l.invoke=function(t,n){return l(t).dispatch("post",[n,G(arguments,2)])},v.prototype.send=v.prototype.mcall=v.prototype.invoke=function(t){return this.dispatch("post",[t,G(arguments,1)])},l.fapply=function(t,n){return l(t).dispatch("apply",[void 0,n])},v.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},l["try"]=l.fcall=function(t){return l(t).dispatch("apply",[void 0,G(arguments,1)])},v.prototype.fcall=function(){return this.dispatch("apply",[void 0,G(arguments)])},l.fbind=function(t){var n=l(t),e=G(arguments,1);return function(){return n.dispatch("apply",[this,e.concat(G(arguments))])}},v.prototype.fbind=function(){var t=this,n=G(arguments);return function(){return t.dispatch("apply",[this,n.concat(G(arguments))])}},l.keys=function(t){return l(t).dispatch("keys",[])},v.prototype.keys=function(){return this.dispatch("keys",[])},l.all=z,v.prototype.all=function(){return z(this)},l.any=B,v.prototype.any=function(){return B(this)},l.allResolved=f(L,"allResolved","allSettled"),v.prototype.allResolved=function(){return L(this)},l.allSettled=P,v.prototype.allSettled=function(){return this.then(function(t){return z(Z(t,function(t){function n(){return t.inspect()}return t=l(t),t.then(n,n)}))})},l.fail=l["catch"]=function(t,n){return l(t).then(void 0,n)},v.prototype.fail=v.prototype["catch"]=function(t){return this.then(void 0,t)},l.progress=q,v.prototype.progress=function(t){return this.then(void 0,void 0,t)},l.fin=l["finally"]=function(t,n){return l(t)["finally"](n)},v.prototype.fin=v.prototype["finally"]=function(t){return t=l(t),this.then(function(n){return t.fcall().then(function(){return n})},function(n){return t.fcall().then(function(){throw n})})},l.done=function(t,n,e,r){return l(t).done(n,e,r)},v.prototype.done=function(t,e,r){var i=function(t){l.nextTick(function(){if(o(t,u),!l.onerror)throw t;l.onerror(t)})},u=t||e||r?this.then(t,e,r):this;"object"==typeof n&&n&&n.domain&&(i=n.domain.bind(i)),u.then(void 0,i)},l.timeout=function(t,n,e){return l(t).timeout(n,e)},v.prototype.timeout=function(t,n){var e=p(),r=setTimeout(function(){n&&"string"!=typeof n||(n=new Error(n||"Timed out after "+t+" ms"),n.code="ETIMEDOUT"),e.reject(n)},t);return this.then(function(t){clearTimeout(r),e.resolve(t)},function(t){clearTimeout(r),e.reject(t)},e.notify),e.promise},l.delay=function(t,n){return void 0===n&&(n=t,t=void 0),l(t).delay(n)},v.prototype.delay=function(t){return this.then(function(n){var e=p();return setTimeout(function(){e.resolve(n)},t),e.promise})},l.nfapply=function(t,n){return l(t).nfapply(n)},v.prototype.nfapply=function(t){var n=p(),e=G(t);return e.push(n.makeNodeResolver()),this.fapply(e).fail(n.reject),n.promise},l.nfcall=function(t){var n=G(arguments,1);return l(t).nfapply(n)},v.prototype.nfcall=function(){var t=G(arguments),n=p();return t.push(n.makeNodeResolver()),this.fapply(t).fail(n.reject),n.promise},l.nfbind=l.denodeify=function(t){var n=G(arguments,1);return function(){var e=n.concat(G(arguments)),r=p();return e.push(r.makeNodeResolver()),l(t).fapply(e).fail(r.reject),r.promise}},v.prototype.nfbind=v.prototype.denodeify=function(){var t=G(arguments);return t.unshift(this),l.denodeify.apply(void 0,t)},l.nbind=function(t,n){var e=G(arguments,2);return function(){function r(){return t.apply(n,arguments)}var o=e.concat(G(arguments)),i=p();return o.push(i.makeNodeResolver()),l(r).fapply(o).fail(i.reject),i.promise}},v.prototype.nbind=function(){var t=G(arguments,0);return t.unshift(this),l.nbind.apply(void 0,t)},l.nmapply=l.npost=function(t,n,e){return l(t).npost(n,e)},v.prototype.nmapply=v.prototype.npost=function(t,n){var e=G(n||[]),r=p();return e.push(r.makeNodeResolver()),this.dispatch("post",[t,e]).fail(r.reject),r.promise},l.nsend=l.nmcall=l.ninvoke=function(t,n){var e=G(arguments,2),r=p();return e.push(r.makeNodeResolver()),l(t).dispatch("post",[n,e]).fail(r.reject),r.promise},v.prototype.nsend=v.prototype.nmcall=v.prototype.ninvoke=function(t){var n=G(arguments,1),e=p();return n.push(e.makeNodeResolver()),this.dispatch("post",[t,n]).fail(e.reject),e.promise},l.nodeify=Y,v.prototype.nodeify=function(t){return t?void this.then(function(n){l.nextTick(function(){t(null,n)})},function(n){l.nextTick(function(){t(n)})}):this};var st=s();return l})}).call(this,n("_process"))},{_process:1}],5:[function(t,n,e){function r(t,n,e){var r;return r=n?new i(t,n):new i(t)}var o=function(){return this}(),i=o.WebSocket||o.MozWebSocket;n.exports=i?r:null,i&&(r.prototype=i.prototype)},{}],6:[function(t,n,e){n.exports={getAccessToken:function(){return"xxwmn93p0h"}}},{}],7:[function(t,n,e){var r,o,i,u;u=t("./protocol"),o=t("./really-error"),i=t("lodash"),r=function(){function t(){this.tag=0,this._callbacks={}}var n;return t.prototype.handle=function(t){var n,e;if(!(t.tag in this._callbacks))throw new o("A message with this tag: "+t.tag+" doesn't exist");if(e=t.tag,u.isErrorMessage(t))try{this._callbacks[e].error.call(null,t)}catch(r){throw n=r,new o("Error happened when trying to execute your error callback")}else try{this._callbacks[e].success.call(null,t)}catch(r){throw n=r,new o("Error happened when trying to execute your success callback")}try{this._callbacks[e].complete.call(null,t)}catch(r){throw n=r,new o("Error happened when trying to execute your complete callback")}return delete this._callbacks[e]},t.prototype.add=function(t){var e,r,o,u,a;return null==t&&(t={}),o=t.kind,u=t.success,r=t.error,e=t.complete,null==o&&(o="default"),null==u&&(u=i.noop),null==r&&(r=i.noop),null==e&&(e=i.noop),a=n.call(this),this._callbacks[a]={kind:o,success:u,error:r,complete:e},a},n=function(){return this.tag+=1},t}(),n.exports=r},{"./protocol":10,"./really-error":13,lodash:3}],8:[function(t,n,e){var r,o,i,u,a;a=t("./protocol"),i=t("q"),o=t("./logger"),u=new o,r=function(){function t(t,n){this.interval=null!=t?t:5e3,this.timeout=null!=n?n:5e3,u.debug("Heartbeat: initialize with interval: "+this.interval+" and timeout: "+this.timeout)}var n;return t.prototype.start=function(t){return this.websocket=t,n.call(this),u.debug("Heartbeat: started interval: "+this.interval+" timeout: "+this.timeout)},n=function(){var t,e,r,o;return e=a.heartbeatMessage(),r=this.websocket.send(e),o=function(t){return function(e){var r,o;return o=Date.now(),r=.001*(o-e.timestamp),u.debug("Heartbeat: lag "+r+" second(s)"),i.delay(t.interval).then(function(){return u.debug("Heartbeat interval: "+t.interval+" timeout: "+t.timeout),n.call(t)})}}(this),t=function(){return u.debug("Heartbeat: lag exceed"),this.websocket.disconnect()},r.timeout(this.interval+this.timeout).then(o,t)},t}(),n.exports=r},{"./logger":9,"./protocol":10,q:4}],9:[function(t,n,e){var r,o,i=[].slice;o=t("lodash"),r=function(){function t(){}return t.prototype.debug=function(){var t,n;return t=1<=arguments.length?i.call(arguments,0):[],t.unshift("Really::Debug::"),"undefined"!=typeof console&&null!==console&&null!=(n=console.debug)&&n.apply(console,t),t},t.prototype.info=function(){var t,n;return t=1<=arguments.length?i.call(arguments,0):[],t.unshift("Really::Info::"),"undefined"!=typeof console&&null!==console&&null!=(n=console.log)&&n.apply(console,t),t},t.prototype.warn=function(){var t,n;return t=1<=arguments.length?i.call(arguments,0):[],t.unshift("Really::Warn::"),"undefined"!=typeof console&&null!==console&&null!=(n=console.warn)&&n.apply(console,t),t},t.prototype.error=function(){var t,n,e,r,u,a;return t=1<=arguments.length?i.call(arguments,0):[],u="Really::Error::",o.isObject(t[0])&&(n=t[0].code,r=t[0].message,e=t[0].errorName,u=""+u+e+"::"+n+":: "+r,t.shift()),t.unshift(u),"undefined"!=typeof console&&null!==console&&null!=(a=console.error)&&a.apply(console,t),t},t}(),n.exports=r},{lodash:3}],10:[function(t,n,e){var r,o,i,u,a=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};i=t("lodash"),u=t("./authenticator"),r=t("./really-error"),o="0",n.exports={clientVersion:o,commands:{init:"init",create:"create",read:"read",get:"get",update:"update","delete":"delete",heartbeat:"poke",subscribe:"subscribe",unsubscribe:"unsubscribe"},initializationMessage:function(t){if(!i.isString(t))throw new r("You should pass accessToken parameter as String");return{kind:"initialization",data:{cmd:this.commands.init,accessToken:t}}},createMessage:function(t,n){var e;if(!i.isString(t))throw new r("You should pass a resource parameter as String");if(!i.isObject(n)&&!i.isUndefined(n))throw new r("You should pass a body parameter as Object");return e={kind:"create",data:{cmd:this.commands.create,r:t}},n&&(e.body=n),e},readMessage:function(t,n){var e,o,u,a,c,s;e=i.omit(n,function(t){return void 0===t}),c={fields:{valid:i.isArray,message:'You should pass Array for "fields" option'},query:{valid:function(t){return i.isObject(t)&&(i.isString(t.filter)||i.isObject(t.values))},message:'You should pass Object for "query" option'},limit:{valid:i.isNumber,message:'You should pass Number for "limit" option'},skip:{valid:i.isNumber,message:'You should pass Number for "skip" option'},sort:{valid:i.isString,message:'You should pass String for "sort" option'},token:{valid:i.isString,message:'You should pass String for "token" option'},includeTotalCount:{valid:i.isBoolean,message:'You should pass Boolean for "includeTotalCount" option'},paginationToken:{valid:i.isString,message:'You should pass String for "paginationToken" option'},subscribe:{valid:i.isBoolean,message:'You should pass Boolean for "subscribe" option'}};for(a in e){if(s=e[a],!(a in c))throw new r('The option "'+a+"\" isn't supported");if(o=c[a],!o.valid(s))throw new r(o.message)}return u={kind:"read",data:{cmd:this.commands.read,r:t}},e&&(u.data.cmdOpts=e),u},getMessage:function(t,n){var e;if(!i.isArray(n))throw new r("You should pass array or nothing for fields option");return e={kind:"get",data:{cmd:this.commands.get,r:t}},n&&(e.data.cmdOpts={fields:n}),e},updateMessage:function(t,n,e){var o,u,c,s,f,l;if(!(i.isArray(e)&&e.length>0))throw new r("You should pass at least one operation");for(l=["set","addNumber","push","addToSet","insertAt","pull","removeAt"],o=0,u=e.length;u>o;o++)if(s=e[o],f=s.op,a.call(l,f)<0)throw new r('"'+s.op+'" operation you passed is not supported');return c={kind:"update",data:{cmd:this.commands.update,rev:n,r:t,body:{ops:e}}}},deleteMessage:function(t){if(!i.isString(t))throw new r("You should pass a resource parameter as String");return{kind:"delete",data:{cmd:this.commands["delete"],r:t}}},subscribeMessage:function(t){var n,e,o,u;if(!i.isPlainObject(t)&&!i.isArray(t))throw new r("subscription(s) should be either Object or Array of Objects");for(i.isArray(t)||(t=[t]),n=0,e=t.length;e>n;n++)if(u=t[n],!i.isNumber(u.rev)||!i.isString(u.res))throw new r("You must pass string resource and number revision for subscription object");return o={kind:"subscribe",data:{cmd:this.commands.subscribe,subscriptions:t}}},unsubscribeMessage:function(t){var n,e,o,u;if(!i.isPlainObject(t)&&!i.isArray(t))throw new r("subscription(s) should be either Object or Array of Objects");for(i.isArray(t)||(t=[t]),n=0,e=t.length;e>n;n++)if(u=t[n],!i.isNumber(u.rev)||!i.isString(u.res))throw new r("You must pass string resource and number revision for subscription object");return o={kind:"unsubscribe",data:{cmd:this.commands.unsubscribe,subscriptions:t}}},heartbeatMessage:function(){var t;return t=Date.now(),{kind:"poke",data:{cmd:this.commands.heartbeat,timestamp:t}}},isErrorMessage:function(t){return i.has(t,"error")}}},{"./authenticator":6,"./really-error":13,lodash:3}],11:[function(t,n,e){var r;r=t("./really-error"),n.exports={handle:function(t,n){var e,o;switch(null==n&&(n={}),o=n.r,e=n.evt,e){case"updated":case"deleted":return t.object.emit(o+":"+e,n);case"created":return t.collection.emit(o+":"+e,n);case"kicked":case"revoked":return t.emit(e,n);default:throw new r("Unknown event: "+e)}}}},{"./really-error":13}],12:[function(t,n,e){var r,o,i,u,a,c;a=t("lodash"),o=t("q"),c=t("./protocol"),u=t("./really-error"),r=t("component-emitter"),i=function(){function t(t){this.channel=t,r(this)}return t.prototype.create=function(t,n){var e,r,i,s,f,l,p;if(null==n&&(n={}),!a.isString(t))throw new u("Can not be initialized without resource");r=new o.defer,p=n.onSuccess,l=n.onError,f=n.onComplete,e=n.body;try{s=c.createMessage(t,e)}catch(h){return i=h,setTimeout(function(){return r.reject(i)},0),r.promise}return this.channel.send(s,{success:p,error:l,complete:f})},t.prototype.read=function(t,n){var e,r,i,s,f,l,p;if(null==n&&(n={}),!a.isString(t))throw new u("Can not be initialized without resource");e=new o.defer,l=n.onSuccess,f=n.onError,s=n.onComplete,p=a.omit(n,["onSuccess","onError","onComplete"]);try{i=c.readMessage(t,p)}catch(h){return r=h,setTimeout(function(){return e.reject(r)},0),e.promise}return this.channel.send(i,{success:l,error:f,complete:s})},t.prototype.onCreate=function(t,n){return this.on(t+":created",function(t){return n(t)})},t}(),n.exports=i},{"./protocol":10,"./really-error":13,"component-emitter":2,lodash:3,q:4}],13:[function(t,n,e){var r,o=function(t,n){function e(){this.constructor=t}for(var r in n)i.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},i={}.hasOwnProperty;r=function(t){function n(t){this.message=null!=t?t:"Unknown Error","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n),this.name="ReallyError"}return o(n,t),n}(Error),n.exports=r},{}],14:[function(t,n,e){var r,o,i,u,a,c;a=t("lodash"),o=t("q"),c=t("./protocol"),i=t("./really-error"),r=t("component-emitter"),u=function(){function t(t){this.channel=t,r(this)}return t.prototype.get=function(t,n){var e,r,u,s,f,l,p;if(!a.isString(t))throw new i("Can not be initialized without resource");e=new o.defer,u=n.fields,p=n.onSuccess,l=n.onError,f=n.onComplete;try{s=c.getMessage(t,u)}catch(h){return r=h,setTimeout(function(){return e.reject(r)},0),e.promise}return this.channel.send(s,{success:p,error:l,complete:f})},t.prototype.update=function(t,n,e){var r,u,s,f,l,p,h;if(!a.isString(t))throw new i("Can not be initialized without resource");if(r=new o.defer,!e)return r.reject(new i("Can't be called without passing arguments")),r.promise;h=e.ops,p=e.onSuccess,l=e.onError,f=e.onComplete;try{s=c.updateMessage(t,n,h)}catch(d){return u=d,setTimeout(function(){return r.reject(u)},0),r.promise}return this.channel.send(s,{success:p,error:l,complete:f})},t.prototype["delete"]=function(t,n){var e,r,o,u;if(!a.isString(t))throw new i("Can not be initialized without resource");return u=n.onSuccess,o=n.onError,r=n.onComplete,e=c.deleteMessage(t),this.channel.send(e,{success:u,error:o,complete:r})},t.prototype.onUpdate=function(t,n){return this.on(t+":updated",function(t){return n(t)})},t.prototype.onDelete=function(t,n){return this.on(t+":deleted",function(t){return n(t)})},t}(),n.exports=u},{"./protocol":10,"./really-error":13,"component-emitter":2,lodash:3,q:4}],15:[function(t,n,e){var r,o,i,u,a,c,s,f;c=t("./transports/webSocket"),a=t("./really-object"),i=t("./really-collection"),u=t("./really-error"),s=t("lodash"),r=t("./push-handler"),f={},o=function(){function t(t,n,e){if(!t||!n)throw new u("Can't initialize Really without passing domain and access token");if(!s.isString(t)||!s.isString(n))throw new u("Only <String> values are allowed for domain and access token");return f[t]?(this.object=f[t].object,this.collection=f[t].collection,this.transport=f[t].transport):(f[t]={},this.transport=new c(t,n,e),this.transport.connect(),f[t].transport=this.transport,this.object=f[t].object=new a(this.transport),this.collection=f[t].collection=new i(this.transport),this.transport.on("message",function(t){return function(n){return s.has(n,"tag")?void 0:r.handle(t,n)}}(this))),this}return t}(),n.exports=o},{"./push-handler":11,"./really-collection":12,"./really-error":13,"./really-object":14,"./transports/webSocket":17,lodash:3}],16:[function(t,n,e){var r;r=function(){function t(t){this.url=t}return t.prototype.connect=function(){return void 0},t.prototype.disconnect=function(){return void 0},t.prototype.send=function(t){return void 0},t.prototype.isConnected=function(){return void 0},t.prototype.on=function(t,n){return void 0},t}(),n.exports=r},{}],17:[function(t,n,e){var r,o,i,u,a,c,s,f,l,p,h=function(t,n){function e(){this.constructor=t}for(var r in n)d.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},d={}.hasOwnProperty;l=t("lodash"),c=t("../transport"),a=t("../really-error"),s=t("ws"),p=t("../protocol"),o=t("component-emitter"),r=t("../callbacks-buffer"),u=t("q"),i=t("../heartbeat"),f=function(t){function n(t,n,e){var i;this.domain=t,this.accessToken=n,this.options=null!=e?e:{},this.socket=null,this.callbacksBuffer=new r,this._messagesBuffer=[],this.initialized=!1,this.url=this.domain+"/v"+p.clientVersion+"/socket",i={reconnectionMaxTimeout:3e4,heartbeatTimeout:2e3,heartbeatInterval:5e3,reconnect:!0,onDisconnect:"buffer"},this.options=l.defaults(this.options,i),o(this)}var e,c,f;return h(n,t),e=function(t){return this.socket.addEventListener("open",function(n){return function(){return n.attempts=0,t.resolve(),f.call(n),n.emit("opened")}}(this)),this.socket.addEventListener("close",function(t){return function(){return t.options.reconnect?(t.emit("reconnecting"),t.reconnect(t.options.reconnectionMaxTimeout)):(t.emit("closed"),t.disconnect())}}(this)),this.socket.addEventListener("error",function(t){return function(){return t.emit("error")}}(this)),this.socket.addEventListener("message",function(t){return function(n){var e;return e=JSON.parse(n.data),l.has(e,"tag")&&t.callbacksBuffer.handle(e),t.emit("message",e)}}(this))},n.prototype.send=function(t,n,e){var r,o,i,c,s,f;return null==n&&(n={}),null==e&&(e=u.defer()),this.isConnected()?(c=t.kind,f=function(t){return"function"==typeof n.success&&n.success(t),e.resolve(t)},i=function(t){return"function"==typeof n.error&&n.error(t),e.reject(new a(t))},o=function(t){return"function"==typeof n.complete?n.complete(t):void 0},t.data.tag=this.callbacksBuffer.add({kind:c,success:f,error:i,complete:o}),this.socket.send(JSON.stringify(t.data)),e.promise):(s=l.isFunction(this.options.onDisconnect)?"custom":this.options.onDisconnect,r=function(r){return function(o){var i,u,c,s,f;null==o&&(o="fail"),s=function(){return e.reject(new a("Connection to the server is not established"))},i=function(){return r._messagesBuffer.push({message:t,options:n,deferred:e})},u=function(){var t;try{return r.options.onDisconnect(r,r._messagesBuffer,a)}catch(n){throw t=n,new a("error invoking custom callback")}},f={fail:s,buffer:i,custom:u};try{return f[o]()}catch(l){if(c=l,c instanceof a)throw c;throw new a("Strategy not found")}}}(this),r(s),e.promise)},f=function(){var t,n,e;return e=function(t){return function(n){var e;return t.initialized=!0,l.flush.call(t),e=new i(t.options.heartbeatInterval,t.options.heartbeatTimeout),e.start(t),t.emit("initialized",n)}}(this),t=function(t){return function(n){return t.initialized=!1,t.emit("initializationError",n)}}(this),n=p.initializationMessage(this.accessToken),this.send(n,{success:e,error:t})},n.prototype.connect=function(t){return null==t&&(t=u.defer()),this.socket=new s(this.url),this.socket.addEventListener("error",l.once(function(){return void 0})),e.call(this,t),t.promise},n.prototype.reconnect=function(){var t;return t=function(t){return function(){var n;return n=1e3*(Math.pow(2,t.attemps)-1),n>t.options.reconnectionMaxTimeout&&(n=t.options.reconnectionMaxTimeout),Math.random()*n}}(this),this.attempts+=1,this.connect().timeout(t())["catch"](function(t){return reconnect()})},l.flush=function(){return setTimeout(function(t){return function(){var n,e,r,o,i,u,a,c;for(u=t._messagesBuffer,c=[],e=0,r=u.length;r>e;e++)a=u[e],o=a.message,i=a.options,n=a.deferred,c.push(t.send(o,i,n));return c}}(this),0)},n.prototype.isConnected=function(){return this.socket?this.socket.readyState===this.socket.OPEN:!1},n.prototype.isConnecting=function(){return this.socket?this.socket.readyState===this.socket.CONNECTING:!1},c=function(){return this.off()},n.prototype.disconnect=function(){var t;return null!=(t=this.socket)&&t.close(),c.call(this),this.socket=null,this.initialized=!1},n}(c),n.exports=f},{"../callbacks-buffer":7,"../heartbeat":8,"../protocol":10,"../really-error":13,"../transport":16,"component-emitter":2,lodash:3,q:4,ws:5}]},{},[15])(15)});